# hse_mlds_regression_with_inference

**Что было сделано** </br>
1) EDA (включая обработку отсутствующих значений);
2) Осуществлено обучение моделей (с применением GridSearchCV):
   * Линейная регрессия на вещественных признаках;
   * Линейная регрессия с L1, L2 - регуляризацией на всех признаках;
   * Feature Engineering и обучение линейной регрессии с L2 - регуляризацией.
3) Оценка бизнес метрики;
4) Реализация сервиса на FastAPI.

**Метрики лучшей модели** </br>
Наибольший вклад в качество модели внес Feature Engineering с добавлением полиномиальных параметров, применением KNNImputer, генирации новых признаков из имеющихся и one hot кодирования.
1) На трейне:
  * R2: 0.8024705606799342
  * MSE: 56619510263.468666
2) На тесте:
  * R2: 0.7981321338821434
  * MSE: 116039413910.34236

**Реализация сервиса на FastAPI** </br>
В ходе работы было реализовано 4 пути:

1) post("/predict_item"), который получает на вход один объект описанного класса Item возвращает predict: float
![2023-11-19_15-51-34](https://github.com/poskryobik/hse_mlds_regression_with_inference/assets/94842481/003274e4-59f1-464b-a9d7-97b932c84604)

2) @app.post("/predict_items"), который получает на вход коллекцию (list) объектов описанного класса Item возвращает список предиктов List[float]
![2023-11-19_15-54-15](https://github.com/poskryobik/hse_mlds_regression_with_inference/assets/94842481/efbbdd4b-f8c7-4e0a-a1b0-c835e2f61d98)

3) @app.post("/uploadcsv"), который на вход получает csv-файл с признаками тестовых объектов, на выход возвращает этот файл с +1 столбцом - предсказаниями на этих объектах
![2023-11-19_16-00-10](https://github.com/poskryobik/hse_mlds_regression_with_inference/assets/94842481/3c9c0834-72f6-4880-9b44-9db21b78ed69)

4) @app.get("/getcsv"), для скачивания csv файла, с ранее посчитанными предиктами.




